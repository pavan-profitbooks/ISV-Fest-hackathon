<h1 class="mb-4"><i class="fas fa-trophy"></i> Top Vendors by Spending</h1>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <%= form_with url: top_vendors_reports_path, method: :get, local: true, class: 'row g-3' do |f| %>
      <div class="col-md-3">
        <%= f.label :start_date, 'Start Date', class: 'form-label' %>
        <%= f.date_field :start_date, value: @start_date, class: 'form-control' %>
      </div>
      <div class="col-md-3">
        <%= f.label :end_date, 'End Date', class: 'form-label' %>
        <%= f.date_field :end_date, value: @end_date, class: 'form-control' %>
      </div>
      <div class="col-md-3">
        <%= f.label :limit, 'Top N Vendors', class: 'form-label' %>
        <%= f.number_field :limit, value: @limit, class: 'form-control', min: 1, max: 50 %>
      </div>
      <div class="col-md-3 d-flex align-items-end">
        <%= f.submit 'Generate Report', class: 'btn btn-primary w-100' %>
      </div>
    <% end %>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-white">
    <h5 class="mb-0">Top <%= @limit %> Vendors</h5>
  </div>
  <div class="card-body">
    <% if @top_vendors.any? %>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>#</th>
              <th>Vendor Name</th>
              <th>Total Spent</th>
              <th>Transactions</th>
              <th>Average</th>
            </tr>
          </thead>
          <tbody>
            <% @top_vendors.each_with_index do |vendor, index| %>
              <tr>
                <td><%= index + 1 %></td>
                <td><strong><%= vendor.name %></strong></td>
                <td class="text-primary fw-bold">$<%= number_with_precision(vendor.total_amount, precision: 2) %></td>
                <td><%= vendor.transaction_count %></td>
                <td>$<%= number_with_precision(vendor.total_amount / vendor.transaction_count, precision: 2) %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p class="text-center text-muted">No vendor data found for the selected date range.</p>
    <% end %>
  </div>
</div>

<div class="mt-3">
  <%= link_to reports_path, class: 'btn btn-secondary' do %>
    <i class="fas fa-arrow-left"></i> Back to Reports
  <% end %>
</div>
