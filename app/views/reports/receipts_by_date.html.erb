<h1 class="mb-4"><i class="fas fa-calendar"></i> Receipts by Date Range</h1>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <%= form_with url: receipts_by_date_reports_path, method: :get, local: true, class: 'row g-3' do |f| %>
      <div class="col-md-4">
        <%= f.label :start_date, 'Start Date', class: 'form-label' %>
        <%= f.date_field :start_date, value: @start_date, class: 'form-control' %>
      </div>
      <div class="col-md-4">
        <%= f.label :end_date, 'End Date', class: 'form-label' %>
        <%= f.date_field :end_date, value: @end_date, class: 'form-control' %>
      </div>
      <div class="col-md-4 d-flex align-items-end">
        <%= f.submit 'Generate Report', class: 'btn btn-primary w-100' %>
      </div>
    <% end %>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-4">
    <div class="card text-white bg-primary">
      <div class="card-body text-center">
        <h3>$<%= number_with_precision(@total, precision: 2) %></h3>
        <p class="mb-0">Total Amount</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-success">
      <div class="card-body text-center">
        <h3><%= @processed %></h3>
        <p class="mb-0">Processed</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-warning">
      <div class="card-body text-center">
        <h3><%= @unprocessed %></h3>
        <p class="mb-0">Unprocessed</p>
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-white">
    <h5 class="mb-0">Receipt Details (<%= @receipts.count %> receipts)</h5>
  </div>
  <div class="card-body">
    <% if @receipts.any? %>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Date</th>
              <th>Merchant</th>
              <th>Vendor</th>
              <th>Amount</th>
              <th>Status</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <% @receipts.each do |receipt| %>
              <tr>
                <td><%= receipt.date.strftime('%b %d, %Y') %></td>
                <td><strong><%= receipt.merchant %></strong></td>
                <td><%= receipt.vendor&.name || 'N/A' %></td>
                <td class="fw-bold text-primary">$<%= number_with_precision(receipt.amount, precision: 2) %></td>
                <td>
                  <% if receipt.expenses.any? %>
                    <span class="badge bg-success">Processed</span>
                  <% else %>
                    <span class="badge bg-warning">Unprocessed</span>
                  <% end %>
                </td>
                <td>
                  <small class="text-muted"><%= receipt.notes.present? ? receipt.notes.truncate(50) : '-' %></small>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p class="text-center text-muted py-4">No receipts found for the selected date range.</p>
    <% end %>
  </div>
</div>

<div class="mt-4">
  <%= link_to reports_path, class: 'btn btn-secondary' do %>
    <i class="fas fa-arrow-left"></i> Back to Reports
  <% end %>
</div>
