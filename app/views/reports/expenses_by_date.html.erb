<h1 class="mb-4"><i class="fas fa-calendar"></i> Expenses by Date Range</h1>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <%= form_with url: expenses_by_date_reports_path, method: :get, local: true, class: 'row g-3' do |f| %>
      <div class="col-md-3">
        <%= f.label :start_date, 'Start Date', class: 'form-label' %>
        <%= f.date_field :start_date, value: @start_date, class: 'form-control' %>
      </div>
      <div class="col-md-3">
        <%= f.label :end_date, 'End Date', class: 'form-label' %>
        <%= f.date_field :end_date, value: @end_date, class: 'form-control' %>
      </div>
      <div class="col-md-3">
        <%= f.label :period, 'Period', class: 'form-label' %>
        <%= f.select :period, [['Monthly', 'monthly'], ['Quarterly', 'quarterly'], ['Yearly', 'yearly']], {}, class: 'form-select' %>
      </div>
      <div class="col-md-3 d-flex align-items-end">
        <%= f.submit 'Generate Report', class: 'btn btn-primary w-100' %>
      </div>
    <% end %>
  </div>
</div>

<div class="row mb-4">
  <div class="col-md-4">
    <div class="card text-white bg-primary">
      <div class="card-body text-center">
        <h3>$<%= number_with_precision(@total, precision: 2) %></h3>
        <p class="mb-0">Total Amount</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-success">
      <div class="card-body text-center">
        <h3><%= @count %></h3>
        <p class="mb-0">Total Expenses</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-info">
      <div class="card-body text-center">
        <h3>$<%= number_with_precision(@average, precision: 2) %></h3>
        <p class="mb-0">Average Amount</p>
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-header bg-white">
    <h5 class="mb-0">Expense Details</h5>
  </div>
  <div class="card-body">
    <% if @expenses.any? %>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Date</th>
              <th>Description</th>
              <th>Category</th>
              <th>Vendor</th>
              <th>Amount</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <% @expenses.each do |expense| %>
              <tr>
                <td><%= expense.date.strftime('%b %d, %Y') %></td>
                <td><%= expense.description.present? ? expense.description : 'N/A' %></td>
                <td><%= expense.category&.name || 'Uncategorized' %></td>
                <td><%= expense.vendor&.name || 'N/A' %></td>
                <td><strong>$<%= number_with_precision(expense.amount, precision: 2) %></strong></td>
                <td><span class="status-badge status-<%= expense.status %>"><%= expense.status %></span></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p class="text-center text-muted">No expenses found for the selected date range.</p>
    <% end %>
  </div>
</div>

<div class="mt-3">
  <%= link_to reports_path, class: 'btn btn-secondary' do %>
    <i class="fas fa-arrow-left"></i> Back to Reports
  <% end %>
</div>
