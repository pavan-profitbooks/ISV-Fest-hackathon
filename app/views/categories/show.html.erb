<style>
  .category-header-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px;
    border-radius: 15px;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
  }

  .expense-list-item {
    background: white;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 15px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.06);
    transition: all 0.3s ease;
  }

  .expense-list-item:hover {
    transform: translateX(5px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="fas fa-tag"></i> <%= @category.name %></h1>
  <div>
    <%= link_to edit_category_path(@category), class: 'btn btn-warning me-2' do %>
      <i class="fas fa-edit"></i> Edit
    <% end %>
    <%= link_to categories_path, class: 'btn btn-secondary' do %>
      <i class="fas fa-arrow-left"></i> Back to Categories
    <% end %>
  </div>
</div>

<div class="category-header-card">
  <div class="row align-items-center">
    <div class="col-md-8">
      <h2 class="mb-3"><%= @category.name %></h2>
      <p class="mb-0" style="font-size: 1.1rem; opacity: 0.9;">
        <%= @category.description.present? ? @category.description : 'No description provided' %>
      </p>
    </div>
    <div class="col-md-4 text-end">
      <div style="font-size: 3rem; font-weight: 700;">
        $<%= number_with_precision(@total_expenses, precision: 2) %>
      </div>
      <div style="font-size: 1.1rem; opacity: 0.9;">
        Total Spent
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-header bg-white">
    <h4 class="mb-0">
      <i class="fas fa-list"></i> Expenses in this Category
      <span class="badge bg-primary"><%= @expenses.count %></span>
    </h4>
  </div>
  <div class="card-body">
    <% if @expenses.any? %>
      <% @expenses.each do |expense| %>
        <div class="expense-list-item">
          <div class="d-flex justify-content-between align-items-center">
            <div class="flex-grow-1">
              <h5 class="mb-2">
                <i class="fas fa-receipt"></i>
                <%= expense.description.present? ? expense.description : 'Expense' %>
              </h5>
              <div class="text-muted">
                <i class="far fa-calendar"></i> <%= expense.date.strftime('%B %d, %Y') %>
                <% if expense.vendor %>
                  â€¢ <i class="fas fa-building"></i> <%= expense.vendor.name %>
                <% end %>
              </div>
            </div>
            <div class="text-end">
              <div style="font-size: 1.5rem; font-weight: 700; color: #43e97b;">
                $<%= number_with_precision(expense.amount, precision: 2) %>
              </div>
              <span class="status-badge status-<%= expense.status %>">
                <%= expense.status %>
              </span>
            </div>
            <div class="ms-3">
              <%= link_to expense_path(expense), class: 'btn btn-sm btn-info' do %>
                <i class="fas fa-eye"></i> View
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="text-center py-5">
        <i class="fas fa-inbox" style="font-size: 4rem; color: #e9ecef; margin-bottom: 20px;"></i>
        <h4 class="text-muted">No expenses in this category yet</h4>
        <p class="text-muted">Create an expense and assign it to this category</p>
        <%= link_to new_expense_path, class: 'btn btn-primary mt-3' do %>
          <i class="fas fa-plus"></i> Add Expense
        <% end %>
      </div>
    <% end %>
  </div>
</div>

<div class="card shadow-sm border-danger">
  <div class="card-header bg-danger text-white">
    <h5 class="mb-0"><i class="fas fa-exclamation-triangle"></i> Danger Zone</h5>
  </div>
  <div class="card-body">
    <p class="text-muted mb-3">
      <% if @expenses.any? %>
        This category has <%= @expenses.count %> expense(s). You must reassign or delete all expenses before deleting this category.
      <% else %>
        Once you delete this category, there is no going back. Please be certain.
      <% end %>
    </p>
    <%= button_to category_path(@category), method: :delete,
        data: { confirm: 'Are you sure you want to delete this category?' },
        class: "btn btn-danger #{'disabled' if @expenses.any?}",
        disabled: @expenses.any? do %>
      <i class="fas fa-trash"></i> Delete Category
    <% end %>
  </div>
</div>
