<style>
  .filter-card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    margin-bottom: 30px;
  }

  .expense-table-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    overflow: hidden;
  }

  .expense-row {
    border-bottom: 1px solid #f0f0f0;
    transition: background 0.2s ease;
  }

  .expense-row:hover {
    background: #f8f9fa;
  }

  .expense-row:last-child {
    border-bottom: none;
  }

  .status-badge {
    padding: 6px 16px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .status-pending {
    background: #fff3cd;
    color: #856404;
  }

  .status-approved {
    background: #d4edda;
    color: #155724;
  }

  .status-rejected {
    background: #f8d7da;
    color: #721c24;
  }

  .total-summary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 20px 30px;
    border-radius: 15px;
    margin-bottom: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
  }

  .total-label {
    font-size: 1.1rem;
    opacity: 0.9;
  }

  .total-amount {
    font-size: 2rem;
    font-weight: 700;
  }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="fas fa-money-bill-wave"></i> Expenses</h1>
  <%= link_to new_expense_path, class: 'btn btn-primary' do %>
    <i class="fas fa-plus"></i> New Expense
  <% end %>
</div>

<div class="total-summary">
  <div class="total-label">
    <i class="fas fa-calculator"></i> Total Expenses
  </div>
  <div class="total-amount">
    $<%= number_with_precision(@total_expenses, precision: 2) %>
  </div>
</div>

<div class="filter-card">
  <h5 class="mb-3"><i class="fas fa-filter"></i> Filter Expenses</h5>
  <%= form_with url: expenses_path, method: :get, local: true, class: 'row g-3' do |f| %>
    <div class="col-md-3">
      <%= f.label :status, 'Status', class: 'form-label' %>
      <%= f.select :status,
          options_for_select([['All Statuses', ''], ['Pending', 'pending'], ['Approved', 'approved'], ['Rejected', 'rejected']], params[:status]),
          {},
          class: 'form-select' %>
    </div>

    <div class="col-md-3">
      <%= f.label :category_id, 'Category', class: 'form-label' %>
      <%= f.select :category_id,
          options_from_collection_for_select(@categories, :id, :name, params[:category_id]),
          { include_blank: 'All Categories' },
          class: 'form-select' %>
    </div>

    <div class="col-md-2">
      <%= f.label :start_date, 'From Date', class: 'form-label' %>
      <%= f.date_field :start_date, value: params[:start_date], class: 'form-control' %>
    </div>

    <div class="col-md-2">
      <%= f.label :end_date, 'To Date', class: 'form-label' %>
      <%= f.date_field :end_date, value: params[:end_date], class: 'form-control' %>
    </div>

    <div class="col-md-2 d-flex align-items-end">
      <%= f.submit 'Apply Filters', class: 'btn btn-primary w-100' %>
    </div>
  <% end %>

  <% if params[:status].present? || params[:category_id].present? || params[:start_date].present? %>
    <div class="mt-3">
      <%= link_to expenses_path, class: 'btn btn-sm btn-outline-secondary' do %>
        <i class="fas fa-times"></i> Clear Filters
      <% end %>
    </div>
  <% end %>
</div>

<% if @expenses.any? %>
  <div class="expense-table-card">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th>Date</th>
            <th>Description</th>
            <th>Vendor</th>
            <th>Category</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @expenses.each do |expense| %>
            <tr class="expense-row">
              <td>
                <i class="far fa-calendar"></i>
                <%= expense.date.strftime('%b %d, %Y') %>
              </td>
              <td>
                <strong><%= expense.description.present? ? expense.description : 'No description' %></strong>
              </td>
              <td>
                <% if expense.vendor %>
                  <i class="fas fa-building"></i> <%= expense.vendor.name %>
                <% else %>
                  <span class="text-muted">N/A</span>
                <% end %>
              </td>
              <td>
                <% if expense.category %>
                  <i class="fas fa-tag"></i> <%= expense.category.name %>
                <% else %>
                  <span class="text-muted">Uncategorized</span>
                <% end %>
              </td>
              <td>
                <strong style="color: #43e97b; font-size: 1.1rem;">
                  $<%= number_with_precision(expense.amount, precision: 2) %>
                </strong>
              </td>
              <td>
                <span class="status-badge status-<%= expense.status %>">
                  <%= expense.status %>
                </span>
              </td>
              <td>
                <%= link_to expense, class: 'btn btn-sm btn-info me-1' do %>
                  <i class="fas fa-eye"></i>
                <% end %>
                <%= link_to edit_expense_path(expense), class: 'btn btn-sm btn-warning me-1' do %>
                  <i class="fas fa-edit"></i>
                <% end %>
                <%= button_to expense, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-sm btn-danger' do %>
                  <i class="fas fa-trash"></i>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
<% else %>
  <div class="card shadow-sm text-center py-5">
    <div class="card-body">
      <i class="fas fa-money-bill-wave" style="font-size: 4rem; color: #ccc; margin-bottom: 20px;"></i>
      <h4 class="text-muted">No expenses found</h4>
      <p class="text-muted">
        <% if params[:status].present? || params[:category_id].present? || params[:start_date].present? %>
          Try adjusting your filters or clear them to see all expenses.
        <% else %>
          Get started by creating your first expense.
        <% end %>
      </p>
      <%= link_to new_expense_path, class: 'btn btn-primary mt-3' do %>
        <i class="fas fa-plus"></i> Create Your First Expense
      <% end %>
    </div>
  </div>
<% end %>
