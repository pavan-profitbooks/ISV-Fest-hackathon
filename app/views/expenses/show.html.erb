<style>
  .expense-detail-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    margin-bottom: 30px;
  }

  .expense-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 15px 15px 0 0;
  }

  .expense-amount-large {
    font-size: 3rem;
    font-weight: 700;
    margin: 20px 0;
  }

  .detail-row {
    padding: 20px 0;
    border-bottom: 1px solid #f0f0f0;
  }

  .detail-row:last-child {
    border-bottom: none;
  }

  .detail-label {
    font-weight: 600;
    color: #7f8c8d;
    margin-bottom: 5px;
  }

  .detail-value {
    font-size: 1.1rem;
    color: #2c3e50;
  }

  .action-section {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 0 0 15px 15px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1><i class="fas fa-money-bill-wave"></i> Expense Details</h1>
  <div>
    <%= link_to edit_expense_path(@expense), class: 'btn btn-warning me-2' do %>
      <i class="fas fa-edit"></i> Edit
    <% end %>
    <%= link_to expenses_path, class: 'btn btn-secondary' do %>
      <i class="fas fa-arrow-left"></i> Back to Expenses
    <% end %>
  </div>
</div>

<div class="expense-detail-card">
  <div class="expense-header">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h3><i class="fas fa-receipt"></i> <%= @expense.description.present? ? @expense.description : 'Expense' %></h3>
        <div class="mt-2">
          <span class="status-badge status-<%= @expense.status %>">
            <%= @expense.status %>
          </span>
        </div>
      </div>
      <div class="text-end">
        <div class="expense-amount-large">
          $<%= number_with_precision(@expense.amount, precision: 2) %>
        </div>
      </div>
    </div>
  </div>

  <div class="card-body">
    <div class="row">
      <div class="col-md-6">
        <div class="detail-row">
          <div class="detail-label">
            <i class="far fa-calendar"></i> Date
          </div>
          <div class="detail-value">
            <%= @expense.date.strftime('%B %d, %Y') %>
          </div>
        </div>

        <div class="detail-row">
          <div class="detail-label">
            <i class="fas fa-building"></i> Vendor
          </div>
          <div class="detail-value">
            <% if @expense.vendor %>
              <%= link_to vendor_path(@expense.vendor), class: 'text-decoration-none' do %>
                <i class="fas fa-store"></i> <%= @expense.vendor.name %>
              <% end %>
            <% else %>
              <span class="text-muted">No vendor assigned</span>
            <% end %>
          </div>
        </div>

        <div class="detail-row">
          <div class="detail-label">
            <i class="fas fa-tag"></i> Category
          </div>
          <div class="detail-value">
            <% if @expense.category %>
              <%= @expense.category.name %>
            <% else %>
              <span class="text-muted">Uncategorized</span>
            <% end %>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="detail-row">
          <div class="detail-label">
            <i class="fas fa-receipt"></i> Receipt
          </div>
          <div class="detail-value">
            <% if @expense.receipt %>
              <span><i class="fas fa-file-invoice"></i> <%= @expense.receipt.merchant %> - $<%= number_with_precision(@expense.receipt.amount, precision: 2) %></span>
            <% else %>
              <span class="text-muted">No receipt attached</span>
            <% end %>
          </div>
        </div>

        <div class="detail-row">
          <div class="detail-label">
            <i class="fas fa-align-left"></i> Description
          </div>
          <div class="detail-value">
            <%= @expense.description.present? ? @expense.description : '<span class="text-muted">No description provided</span>'.html_safe %>
          </div>
        </div>

        <div class="detail-row">
          <div class="detail-label">
            <i class="fas fa-info-circle"></i> Status
          </div>
          <div class="detail-value">
            <span class="status-badge status-<%= @expense.status %>">
              <%= @expense.status.capitalize %>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="action-section">
    <% if @expense.status == 'pending' %>
      <%= button_to approve_expense_path(@expense), method: :patch, class: 'btn btn-success' do %>
        <i class="fas fa-check"></i> Approve Expense
      <% end %>
      <%= button_to reject_expense_path(@expense), method: :patch, class: 'btn btn-danger' do %>
        <i class="fas fa-times"></i> Reject Expense
      <% end %>
    <% end %>

    <%= link_to edit_expense_path(@expense), class: 'btn btn-warning' do %>
      <i class="fas fa-edit"></i> Edit Expense
    <% end %>

    <%= button_to @expense, method: :delete, data: { confirm: 'Are you sure you want to delete this expense?' }, class: 'btn btn-outline-danger' do %>
      <i class="fas fa-trash"></i> Delete Expense
    <% end %>
  </div>
</div>

<% if @expense.created_at %>
  <div class="text-muted small text-center">
    Created <%= time_ago_in_words(@expense.created_at) %> ago
    <% if @expense.updated_at != @expense.created_at %>
      â€¢ Updated <%= time_ago_in_words(@expense.updated_at) %> ago
    <% end %>
  </div>
<% end %>
